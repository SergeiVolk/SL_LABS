import shelve

movies = {
    "Аватар 2": {"США": 684000000, "Китай": 245000000, "Индия": 58000000,
                 "Россия": 42000000, "Германия": 38000000, "Франция": 35000000},
    "Оппенгеймер": {"США": 326000000, "Китай": 48000000, "Индия": 19000000,
                    "Россия": 15000000, "Германия": 28000000, "Франция": 22000000},
    "Дюна 2": {"США": 310000000, "Китай": 60000000, "Индия": 25000000,
               "Россия": 20000000, "Германия": 30000000, "Франция": 27000000},
    "Человек-паук: Нет пути домой": {"США": 804000000, "Китай": 10000000, "Индия": 40000000,
                                     "Россия": 35000000, "Германия": 45000000, "Франция": 38000000},
    "Барби": {"США": 635000000, "Китай": 75000000, "Индия": 30000000,
              "Россия": 25000000, "Германия": 40000000, "Франция": 37000000},
    "Доктор Стрэндж 2": {"США": 411000000, "Китай": 52000000, "Индия": 22000000,
                         "Россия": 18000000, "Германия": 29000000, "Франция": 26000000},
    "Форсаж 9": {"США": 173000000, "Китай": 136000000, "Индия": 45000000,
                 "Россия": 30000000, "Германия": 25000000, "Франция": 24000000}
}

print("Суммарные сборы фильмов:")
totals = {}
for movie, countries in movies.items():
    total = sum(countries.values())
    totals[movie] = total
    print(f"{movie}: {total}")


max_movie = max(totals, key=totals.get)
min_movie = min(totals, key=totals.get)
print(f"\nМаксимальные сборы: {max_movie} ({totals[max_movie]})")
print(f"Минимальные сборы: {min_movie} ({totals[min_movie]})")


threshold = totals[min_movie] * 1.25
print("\nФильмы, превосходящие минимум более чем на 25%:")
for movie, total in totals.items():
    if total > threshold:
        print(f"{movie}: {total}")


print("\nФильмы, где Китай < Индия:")
for movie, countries in movies.items():
    if countries["Китай"] < countries["Индия"]:
        print(movie)


with shelve.open("movies_db") as db:
    db["movies"] = movies



